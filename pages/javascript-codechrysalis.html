<!DOCTYPE html><html><head><meta charset="utf-8"><style>@font-face {
  font-family: octicons-anchor;
  src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAYcAA0AAAAACjQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAABMAAAABwAAAAca8vGTk9TLzIAAAFMAAAARAAAAFZG1VHVY21hcAAAAZAAAAA+AAABQgAP9AdjdnQgAAAB0AAAAAQAAAAEACICiGdhc3AAAAHUAAAACAAAAAj//wADZ2x5ZgAAAdwAAADRAAABEKyikaNoZWFkAAACsAAAAC0AAAA2AtXoA2hoZWEAAALgAAAAHAAAACQHngNFaG10eAAAAvwAAAAQAAAAEAwAACJsb2NhAAADDAAAAAoAAAAKALIAVG1heHAAAAMYAAAAHwAAACABEAB2bmFtZQAAAzgAAALBAAAFu3I9x/Nwb3N0AAAF/AAAAB0AAAAvaoFvbwAAAAEAAAAAzBdyYwAAAADP2IQvAAAAAM/bz7t4nGNgZGFgnMDAysDB1Ml0hoGBoR9CM75mMGLkYGBgYmBlZsAKAtJcUxgcPsR8iGF2+O/AEMPsznAYKMwIkgMA5REMOXicY2BgYGaAYBkGRgYQsAHyGMF8FgYFIM0ChED+h5j//yEk/3KoSgZGNgYYk4GRCUgwMaACRoZhDwCs7QgGAAAAIgKIAAAAAf//AAJ4nHWMMQrCQBBF/0zWrCCIKUQsTDCL2EXMohYGSSmorScInsRGL2DOYJe0Ntp7BK+gJ1BxF1stZvjz/v8DRghQzEc4kIgKwiAppcA9LtzKLSkdNhKFY3HF4lK69ExKslx7Xa+vPRVS43G98vG1DnkDMIBUgFN0MDXflU8tbaZOUkXUH0+U27RoRpOIyCKjbMCVejwypzJJG4jIwb43rfl6wbwanocrJm9XFYfskuVC5K/TPyczNU7b84CXcbxks1Un6H6tLH9vf2LRnn8Ax7A5WQAAAHicY2BkYGAA4teL1+yI57f5ysDNwgAC529f0kOmWRiYVgEpDgYmEA8AUzEKsQAAAHicY2BkYGB2+O/AEMPCAAJAkpEBFbAAADgKAe0EAAAiAAAAAAQAAAAEAAAAAAAAKgAqACoAiAAAeJxjYGRgYGBhsGFgYgABEMkFhAwM/xn0QAIAD6YBhwB4nI1Ty07cMBS9QwKlQapQW3VXySvEqDCZGbGaHULiIQ1FKgjWMxknMfLEke2A+IJu+wntrt/QbVf9gG75jK577Lg8K1qQPCfnnnt8fX1NRC/pmjrk/zprC+8D7tBy9DHgBXoWfQ44Av8t4Bj4Z8CLtBL9CniJluPXASf0Lm4CXqFX8Q84dOLnMB17N4c7tBo1AS/Qi+hTwBH4rwHHwN8DXqQ30XXAS7QaLwSc0Gn8NuAVWou/gFmnjLrEaEh9GmDdDGgL3B4JsrRPDU2hTOiMSuJUIdKQQayiAth69r6akSSFqIJuA19TrzCIaY8sIoxyrNIrL//pw7A2iMygkX5vDj+G+kuoLdX4GlGK/8Lnlz6/h9MpmoO9rafrz7ILXEHHaAx95s9lsI7AHNMBWEZHULnfAXwG9/ZqdzLI08iuwRloXE8kfhXYAvE23+23DU3t626rbs8/8adv+9DWknsHp3E17oCf+Z48rvEQNZ78paYM38qfk3v/u3l3u3GXN2Dmvmvpf1Srwk3pB/VSsp512bA/GG5i2WJ7wu430yQ5K3nFGiOqgtmSB5pJVSizwaacmUZzZhXLlZTq8qGGFY2YcSkqbth6aW1tRmlaCFs2016m5qn36SbJrqosG4uMV4aP2PHBmB3tjtmgN2izkGQyLWprekbIntJFing32a5rKWCN/SdSoga45EJykyQ7asZvHQ8PTm6cslIpwyeyjbVltNikc2HTR7YKh9LBl9DADC0U/jLcBZDKrMhUBfQBvXRzLtFtjU9eNHKin0x5InTqb8lNpfKv1s1xHzTXRqgKzek/mb7nB8RZTCDhGEX3kK/8Q75AmUM/eLkfA+0Hi908Kx4eNsMgudg5GLdRD7a84npi+YxNr5i5KIbW5izXas7cHXIMAau1OueZhfj+cOcP3P8MNIWLyYOBuxL6DRylJ4cAAAB4nGNgYoAALjDJyIAOWMCiTIxMLDmZedkABtIBygAAAA==) format('woff');
}

* {
    box-sizing: border-box;
}

body {
    width: 980px;
    margin-right: auto;
    margin-left: auto;
}

body .markdown-body {
    padding: 45px;
    border: 1px solid #ddd;
    border-radius: 3px;
    word-wrap: break-word;
}

pre {
    font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  color: #333;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body strong {
  font-weight: bold;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body input {
  font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}

.markdown-body a {
  color: #4078c0;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before {
  display: table;
  content: "";
}

.markdown-body hr:after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
  font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body .select::-ms-expand {
  opacity: 0;
}

.markdown-body .octicon {
  font: normal normal normal 16px/1 octicons-anchor;
  display: inline-block;
  text-decoration: none;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.markdown-body .octicon-link:before {
  content: '\f05c';
}

.markdown-body:before {
  display: table;
  content: "";
}

.markdown-body:after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body .anchor {
  display: inline-block;
  padding-right: 2px;
  margin-left: -18px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: #000;
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h1 .anchor {
  line-height: 1;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 .anchor {
  line-height: 1;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h3 .anchor {
  line-height: 1.2;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h4 .anchor {
  line-height: 1.2;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h5 .anchor {
  line-height: 1.1;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body h6 .anchor {
  line-height: 1.1;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  box-sizing: content-box;
  background-color: #fff;
}

.markdown-body code {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

.markdown-body kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb;
}

.markdown-body .pl-c {
  color: #969896;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: #0086b3;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #795da3;
}

.markdown-body .pl-s .pl-s1,
.markdown-body .pl-smi {
  color: #333;
}

.markdown-body .pl-ent {
  color: #63a35c;
}

.markdown-body .pl-k {
  color: #a71d5d;
}

.markdown-body .pl-pds,
.markdown-body .pl-s,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sra,
.markdown-body .pl-sr .pl-sre {
  color: #183691;
}

.markdown-body .pl-v {
  color: #ed6a43;
}

.markdown-body .pl-id {
  color: #b52a1d;
}

.markdown-body .pl-ii {
  background-color: #b52a1d;
  color: #f8f8f8;
}

.markdown-body .pl-sr .pl-cce {
  color: #63a35c;
  font-weight: bold;
}

.markdown-body .pl-ml {
  color: #693a17;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  color: #1d3e81;
  font-weight: bold;
}

.markdown-body .pl-mq {
  color: #008080;
}

.markdown-body .pl-mi {
  color: #333;
  font-style: italic;
}

.markdown-body .pl-mb {
  color: #333;
  font-weight: bold;
}

.markdown-body .pl-md {
  background-color: #ffecec;
  color: #bd2c00;
}

.markdown-body .pl-mi1 {
  background-color: #eaffea;
  color: #55a532;
}

.markdown-body .pl-mdr {
  color: #795da3;
  font-weight: bold;
}

.markdown-body .pl-mo {
  color: #1d3e81;
}

.markdown-body kbd {
  display: inline-block;
  padding: 3px 5px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb;
}

.markdown-body .plan-price-unit {
  color: #767676;
  font-weight: normal;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 0.35em 0.25em -1.6em;
  vertical-align: middle;
}

.markdown-body .plan-choice {
  padding: 15px;
  padding-left: 40px;
  display: block;
  border: 1px solid #e0e0e0;
  position: relative;
  font-weight: normal;
  background-color: #fafafa;
}

.markdown-body .plan-choice.open {
  background-color: #fff;
}

.markdown-body .plan-choice.open .plan-choice-seat-breakdown {
  display: block;
}

.markdown-body .plan-choice-free {
  border-radius: 3px 3px 0 0;
}

.markdown-body .plan-choice-paid {
  border-radius: 0 0 3px 3px;
  border-top: 0;
  margin-bottom: 20px;
}

.markdown-body .plan-choice-radio {
  position: absolute;
  left: 15px;
  top: 18px;
}

.markdown-body .plan-choice-exp {
  color: #999;
  font-size: 12px;
  margin-top: 5px;
}

.markdown-body .plan-choice-seat-breakdown {
  margin-top: 10px;
  display: none;
}

.markdown-body :checked+.radio-label {
  z-index: 1;
  position: relative;
  border-color: #4078c0;
}
</style><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
MathJax.Hub.Config({
  config: ["MMLorHTML.js"],
  extensions: ["tex2jax.js"],
  jax: ["input/TeX"],
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: false
  },
  TeX: {
    extensions: ["AMSmath.js", "AMSsymbols.js"],
    TagSide: "right",
    TagIndent: ".8em",
    MultLineWidth: "85%",
    equationNumbers: {
      autoNumber: "AMS",
    },
    unicode: {
      fonts: "STIXGeneral,'Arial Unicode MS'"
    }
  },
  showProcessingMessages: false
});
</script>
<script type="text/javascript" charset="utf-8" src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.2/raphael-min.js"></script>
<script type="text/javascript" charset="utf-8" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>
<script type="text/javascript" charset="utf-8" src="https://cdnjs.cloudflare.com/ajax/libs/js-sequence-diagrams/1.0.4/sequence-diagram-min.js"></script>
<script type="text/javascript">// flowchart, v1.3.4
// Copyright (c)2014 Adriano Raiano (adrai).
// Distributed under MIT license
// http://adrai.github.io/flowchart.js
!function(){function a(b,c){if(!b||"function"==typeof b)return c;var d={};for(var e in c)d[e]=c[e];for(e in b)b[e]&&(d[e]="object"==typeof d[e]?a(d[e],b[e]):b[e]);return d}function b(a,b){if("function"==typeof Object.create)a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});else{a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}}function c(a,b,c){var d,e,f="M{0},{1}";for(d=2,e=2*c.length+2;e>d;d+=2)f+=" L{"+d+"},{"+(d+1)+"}";var g=[b.x,b.y];for(d=0,e=c.length;e>d;d++)g.push(c[d].x),g.push(c[d].y);var h=a.paper.path(f,g);h.attr("stroke",a.options["element-color"]),h.attr("stroke-width",a.options["line-width"]);var i=a.options.font,j=a.options["font-family"],k=a.options["font-weight"];return i&&h.attr({font:i}),j&&h.attr({"font-family":j}),k&&h.attr({"font-weight":k}),h}function d(a,b,c,d){var e,f;"[object Array]"!==Object.prototype.toString.call(c)&&(c=[c]);var g="M{0},{1}";for(e=2,f=2*c.length+2;f>e;e+=2)g+=" L{"+e+"},{"+(e+1)+"}";var h=[b.x,b.y];for(e=0,f=c.length;f>e;e++)h.push(c[e].x),h.push(c[e].y);var i=a.paper.path(g,h);i.attr({stroke:a.options["line-color"],"stroke-width":a.options["line-width"],"arrow-end":a.options["arrow-end"]});var j=a.options.font,k=a.options["font-family"],l=a.options["font-weight"];if(j&&i.attr({font:j}),k&&i.attr({"font-family":k}),l&&i.attr({"font-weight":l}),d){var m=!1,n=a.paper.text(0,0,d),o=!1,p=c[0];b.y===p.y&&(o=!0);var q=0,r=0;m?(q=b.x>p.x?b.x-(b.x-p.x)/2:p.x-(p.x-b.x)/2,r=b.y>p.y?b.y-(b.y-p.y)/2:p.y-(p.y-b.y)/2,o?(q-=n.getBBox().width/2,r-=a.options["text-margin"]):(q+=a.options["text-margin"],r-=n.getBBox().height/2)):(q=b.x,r=b.y,o?(q+=a.options["text-margin"]/2,r-=a.options["text-margin"]):(q+=a.options["text-margin"]/2,r+=a.options["text-margin"])),n.attr({"text-anchor":"start","font-size":a.options["font-size"],fill:a.options["font-color"],x:q,y:r}),j&&n.attr({font:j}),k&&n.attr({"font-family":k}),l&&n.attr({"font-weight":l})}return i}function e(a,b,c,d,e,f,g,h){var i,j,k,l,m,n={x:null,y:null,onLine1:!1,onLine2:!1};return i=(h-f)*(c-a)-(g-e)*(d-b),0===i?n:(j=b-f,k=a-e,l=(g-e)*j-(h-f)*k,m=(c-a)*j-(d-b)*k,j=l/i,k=m/i,n.x=a+j*(c-a),n.y=b+j*(d-b),j>0&&1>j&&(n.onLine1=!0),k>0&&1>k&&(n.onLine2=!0),n)}function f(a,b){b=b||{},this.paper=new Raphael(a),this.options=r.defaults(b,q),this.symbols=[],this.lines=[],this.start=null}function g(a,b,c){this.chart=a,this.group=this.chart.paper.set(),this.symbol=c,this.connectedTo=[],this.symbolType=b.symbolType,this.flowstate=b.flowstate||"future",this.next_direction=b.next&&b.direction_next?b.direction_next:void 0,this.text=this.chart.paper.text(0,0,b.text),b.key&&(this.text.node.id=b.key+"t"),this.text.node.setAttribute("class",this.getAttr("class")+"t"),this.text.attr({"text-anchor":"start",x:this.getAttr("text-margin"),fill:this.getAttr("font-color"),"font-size":this.getAttr("font-size")});var d=this.getAttr("font"),e=this.getAttr("font-family"),f=this.getAttr("font-weight");d&&this.text.attr({font:d}),e&&this.text.attr({"font-family":e}),f&&this.text.attr({"font-weight":f}),b.link&&this.text.attr("href",b.link),b.target&&this.text.attr("target",b.target);var g=this.getAttr("maxWidth");if(g){for(var h=b.text.split(" "),i="",j=0,k=h.length;k>j;j++){var l=h[j];this.text.attr("text",i+" "+l),i+=this.text.getBBox().width>g?"\n"+l:" "+l}this.text.attr("text",i.substring(1))}if(this.group.push(this.text),c){var m=this.getAttr("text-margin");c.attr({fill:this.getAttr("fill"),stroke:this.getAttr("element-color"),"stroke-width":this.getAttr("line-width"),width:this.text.getBBox().width+2*m,height:this.text.getBBox().height+2*m}),c.node.setAttribute("class",this.getAttr("class")),b.link&&c.attr("href",b.link),b.target&&c.attr("target",b.target),b.key&&(c.node.id=b.key),this.group.push(c),c.insertBefore(this.text),this.text.attr({y:c.getBBox().height/2}),this.initialize()}}function h(a,b){var c=a.paper.rect(0,0,0,0,20);b=b||{},b.text=b.text||"Start",g.call(this,a,b,c)}function i(a,b){var c=a.paper.rect(0,0,0,0,20);b=b||{},b.text=b.text||"End",g.call(this,a,b,c)}function j(a,b){var c=a.paper.rect(0,0,0,0);b=b||{},g.call(this,a,b,c)}function k(a,b){var c=a.paper.rect(0,0,0,0);b=b||{},g.call(this,a,b,c),c.attr({width:this.text.getBBox().width+4*this.getAttr("text-margin")}),this.text.attr({x:2*this.getAttr("text-margin")});var d=a.paper.rect(0,0,0,0);d.attr({x:this.getAttr("text-margin"),stroke:this.getAttr("element-color"),"stroke-width":this.getAttr("line-width"),width:this.text.getBBox().width+2*this.getAttr("text-margin"),height:this.text.getBBox().height+2*this.getAttr("text-margin"),fill:this.getAttr("fill")}),b.key&&(d.node.id=b.key+"i");var e=this.getAttr("font"),f=this.getAttr("font-family"),h=this.getAttr("font-weight");e&&d.attr({font:e}),f&&d.attr({"font-family":f}),h&&d.attr({"font-weight":h}),b.link&&d.attr("href",b.link),b.target&&d.attr("target",b.target),this.group.push(d),d.insertBefore(this.text),this.initialize()}function l(a,b){b=b||{},g.call(this,a,b),this.textMargin=this.getAttr("text-margin"),this.text.attr({x:3*this.textMargin});var d=this.text.getBBox().width+4*this.textMargin,e=this.text.getBBox().height+2*this.textMargin,f=this.textMargin,h=e/2,i={x:f,y:h},j=[{x:f-this.textMargin,y:e},{x:f-this.textMargin+d,y:e},{x:f-this.textMargin+d+2*this.textMargin,y:0},{x:f-this.textMargin+2*this.textMargin,y:0},{x:f,y:h}],k=c(a,i,j);k.attr({stroke:this.getAttr("element-color"),"stroke-width":this.getAttr("line-width"),fill:this.getAttr("fill")}),b.link&&k.attr("href",b.link),b.target&&k.attr("target",b.target),b.key&&(k.node.id=b.key),k.node.setAttribute("class",this.getAttr("class")),this.text.attr({y:k.getBBox().height/2}),this.group.push(k),k.insertBefore(this.text),this.initialize()}function m(a,b){b=b||{},g.call(this,a,b),this.textMargin=this.getAttr("text-margin"),this.yes_direction="bottom",this.no_direction="right",b.yes&&b.direction_yes&&b.no&&!b.direction_no?"right"===b.direction_yes?(this.no_direction="bottom",this.yes_direction="right"):(this.no_direction="right",this.yes_direction="bottom"):b.yes&&!b.direction_yes&&b.no&&b.direction_no?"right"===b.direction_no?(this.yes_direction="bottom",this.no_direction="right"):(this.yes_direction="right",this.no_direction="bottom"):(this.yes_direction="bottom",this.no_direction="right"),this.yes_direction=this.yes_direction||"bottom",this.no_direction=this.no_direction||"right",this.text.attr({x:2*this.textMargin});var d=this.text.getBBox().width+3*this.textMargin;d+=d/2;var e=this.text.getBBox().height+2*this.textMargin;e+=e/2,e=Math.max(.5*d,e);var f=d/4,h=e/4;this.text.attr({x:f+this.textMargin/2});var i={x:f,y:h},j=[{x:f-d/4,y:h+e/4},{x:f-d/4+d/2,y:h+e/4+e/2},{x:f-d/4+d,y:h+e/4},{x:f-d/4+d/2,y:h+e/4-e/2},{x:f-d/4,y:h+e/4}],k=c(a,i,j);k.attr({stroke:this.getAttr("element-color"),"stroke-width":this.getAttr("line-width"),fill:this.getAttr("fill")}),b.link&&k.attr("href",b.link),b.target&&k.attr("target",b.target),b.key&&(k.node.id=b.key),k.node.setAttribute("class",this.getAttr("class")),this.text.attr({y:k.getBBox().height/2}),this.group.push(k),k.insertBefore(this.text),this.initialize()}function n(a){function b(a){var b=a.indexOf("(")+1,c=a.indexOf(")");return b>=0&&c>=0?d.symbols[a.substring(0,b-1)]:d.symbols[a]}function c(a){var b="next",c=a.indexOf("(")+1,d=a.indexOf(")");return c>=0&&d>=0&&(b=D.substring(c,d),b.indexOf(",")<0&&"yes"!==b&&"no"!==b&&(b="next, "+b)),b}a=a||"",a=a.trim();for(var d={symbols:{},start:null,drawSVG:function(a,b){function c(a){if(g[a.key])return g[a.key];switch(a.symbolType){case"start":g[a.key]=new h(e,a);break;case"end":g[a.key]=new i(e,a);break;case"operation":g[a.key]=new j(e,a);break;case"inputoutput":g[a.key]=new l(e,a);break;case"subroutine":g[a.key]=new k(e,a);break;case"condition":g[a.key]=new m(e,a);break;default:return new Error("Wrong symbol type!")}return g[a.key]}var d=this;this.diagram&&this.diagram.clean();var e=new f(a,b);this.diagram=e;var g={};!function n(a,b,f){var g=c(a);return d.start===a?e.startWith(g):b&&f&&!b.pathOk&&(b instanceof m?(f.yes===a&&b.yes(g),f.no===a&&b.no(g)):b.then(g)),g.pathOk?g:(g instanceof m?(a.yes&&n(a.yes,g,a),a.no&&n(a.no,g,a)):a.next&&n(a.next,g,a),g)}(this.start),e.render()},clean:function(){this.diagram.clean()}},e=[],g=0,n=1,o=a.length;o>n;n++)if("\n"===a[n]&&"\\"!==a[n-1]){var p=a.substring(g,n);g=n+1,e.push(p.replace(/\\\n/g,"\n"))}g<a.length&&e.push(a.substr(g));for(var q=1,r=e.length;r>q;){var s=e[q];s.indexOf(": ")<0&&s.indexOf("(")<0&&s.indexOf(")")<0&&s.indexOf("->")<0&&s.indexOf("=>")<0?(e[q-1]+="\n"+s,e.splice(q,1),r--):q++}for(;e.length>0;){var t=e.splice(0,1)[0];if(t.indexOf("=>")>=0){var u,v=t.split("=>"),w={key:v[0],symbolType:v[1],text:null,link:null,target:null,flowstate:null};if(w.symbolType.indexOf(": ")>=0&&(u=w.symbolType.split(": "),w.symbolType=u[0],w.text=u[1]),w.text&&w.text.indexOf(":>")>=0?(u=w.text.split(":>"),w.text=u[0],w.link=u[1]):w.symbolType.indexOf(":>")>=0&&(u=w.symbolType.split(":>"),w.symbolType=u[0],w.link=u[1]),w.symbolType.indexOf("\n")>=0&&(w.symbolType=w.symbolType.split("\n")[0]),w.link){var x=w.link.indexOf("[")+1,y=w.link.indexOf("]");x>=0&&y>=0&&(w.target=w.link.substring(x,y),w.link=w.link.substring(0,x-1))}if(w.text&&w.text.indexOf("|")>=0){var z=w.text.split("|");w.text=z[0],w.flowstate=z[1].trim()}d.symbols[w.key]=w}else if(t.indexOf("->")>=0)for(var A=t.split("->"),B=0,C=A.length;C>B;B++){var D=A[B],E=b(D),F=c(D),G=null;if(F.indexOf(",")>=0){var H=F.split(",");F=H[0],G=H[1].trim()}if(d.start||(d.start=E),C>B+1){var I=A[B+1];E[F]=b(I),E["direction_"+F]=G,G=null}}}return d}Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),d!=d?d=0:0!==d&&1/0!=d&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){"use strict";if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!==d&&d!=1/0&&d!=-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d))));for(var e=d>=0?Math.min(d,c-1):c-Math.abs(d);e>=0;e--)if(e in b&&b[e]===a)return e;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var o=this,p={};"undefined"!=typeof module&&module.exports?module.exports=p:o.flowchart=o.flowchart||p;var q={x:0,y:0,"line-width":3,"line-length":50,"text-margin":10,"font-size":14,"font-color":"black","line-color":"black","element-color":"black",fill:"white","yes-text":"yes","no-text":"no","arrow-end":"block","class":"flowchart",symbols:{start:{},end:{},condition:{},inputoutput:{},operation:{},subroutine:{}}},r={defaults:a,inherits:b};f.prototype.handle=function(a){this.symbols.indexOf(a)<=-1&&this.symbols.push(a);var b=this;return a instanceof m?(a.yes=function(c){return a.yes_symbol=c,a.no_symbol&&(a.pathOk=!0),b.handle(c)},a.no=function(c){return a.no_symbol=c,a.yes_symbol&&(a.pathOk=!0),b.handle(c)}):a.then=function(c){return a.next=c,a.pathOk=!0,b.handle(c)},a},f.prototype.startWith=function(a){return this.start=a,this.handle(a)},f.prototype.render=function(){var a,b=0,c=0,d=0,e=0,f=0,g=0;for(d=0,e=this.symbols.length;e>d;d++)a=this.symbols[d],a.width>b&&(b=a.width),a.height>c&&(c=a.height);for(d=0,e=this.symbols.length;e>d;d++)a=this.symbols[d],a.shiftX(this.options.x+(b-a.width)/2+this.options["line-width"]),a.shiftY(this.options.y+(c-a.height)/2+this.options["line-width"]);for(this.start.render(),d=0,e=this.symbols.length;e>d;d++)a=this.symbols[d],a.renderLines();for(f=this.maxXFromLine,d=0,e=this.symbols.length;e>d;d++){a=this.symbols[d];var h=a.getX()+a.width,i=a.getY()+a.height;h>f&&(f=h),i>g&&(g=i)}this.paper.setSize(f+this.options["line-width"],g+this.options["line-width"])},f.prototype.clean=function(){if(this.paper){var a=this.paper.canvas;a.parentNode.removeChild(a)}},g.prototype.getAttr=function(a){if(!this.chart)return void 0;var b,c=this.chart.options?this.chart.options[a]:void 0,d=this.chart.options.symbols?this.chart.options.symbols[this.symbolType][a]:void 0;return this.chart.options.flowstate&&this.chart.options.flowstate[this.flowstate]&&(b=this.chart.options.flowstate[this.flowstate][a]),b||d||c},g.prototype.initialize=function(){this.group.transform("t"+this.getAttr("line-width")+","+this.getAttr("line-width")),this.width=this.group.getBBox().width,this.height=this.group.getBBox().height},g.prototype.getCenter=function(){return{x:this.getX()+this.width/2,y:this.getY()+this.height/2}},g.prototype.getX=function(){return this.group.getBBox().x},g.prototype.getY=function(){return this.group.getBBox().y},g.prototype.shiftX=function(a){this.group.transform("t"+(this.getX()+a)+","+this.getY())},g.prototype.setX=function(a){this.group.transform("t"+a+","+this.getY())},g.prototype.shiftY=function(a){this.group.transform("t"+this.getX()+","+(this.getY()+a))},g.prototype.setY=function(a){this.group.transform("t"+this.getX()+","+a)},g.prototype.getTop=function(){var a=this.getY(),b=this.getX()+this.width/2;return{x:b,y:a}},g.prototype.getBottom=function(){var a=this.getY()+this.height,b=this.getX()+this.width/2;return{x:b,y:a}},g.prototype.getLeft=function(){var a=this.getY()+this.group.getBBox().height/2,b=this.getX();return{x:b,y:a}},g.prototype.getRight=function(){var a=this.getY()+this.group.getBBox().height/2,b=this.getX()+this.group.getBBox().width;return{x:b,y:a}},g.prototype.render=function(){if(this.next){var a=this.getAttr("line-length");if("right"===this.next_direction){var b=this.getRight();if(this.next.getLeft(),!this.next.isPositioned){this.next.setY(b.y-this.next.height/2),this.next.shiftX(this.group.getBBox().x+this.width+a);var c=this;!function e(){for(var b,d=!1,f=0,g=c.chart.symbols.length;g>f;f++){b=c.chart.symbols[f];var h=Math.abs(b.getCenter().x-c.next.getCenter().x);if(b.getCenter().y>c.next.getCenter().y&&h<=c.next.width/2){d=!0;break}}d&&(c.next.setX(b.getX()+b.width+a),e())}(),this.next.isPositioned=!0,this.next.render()}}else{var d=this.getBottom();this.next.getTop(),this.next.isPositioned||(this.next.shiftY(this.getY()+this.height+a),this.next.setX(d.x-this.next.width/2),this.next.isPositioned=!0,this.next.render())}}},g.prototype.renderLines=function(){this.next&&(this.next_direction?this.drawLineTo(this.next,"",this.next_direction):this.drawLineTo(this.next))},g.prototype.drawLineTo=function(a,b,c){this.connectedTo.indexOf(a)<0&&this.connectedTo.push(a);var f,g=this.getCenter().x,h=this.getCenter().y,i=(this.getTop(),this.getRight()),j=this.getBottom(),k=this.getLeft(),l=a.getCenter().x,m=a.getCenter().y,n=a.getTop(),o=a.getRight(),p=(a.getBottom(),a.getLeft()),q=g===l,r=h===m,s=m>h,t=h>m,u=g>l,v=l>g,w=0,x=this.getAttr("line-length"),y=this.getAttr("line-width");if(c&&"bottom"!==c||!q||!s)if(c&&"right"!==c||!r||!v)if(c&&"left"!==c||!r||!u)if(c&&"right"!==c||!q||!t)if(c&&"right"!==c||!q||!s)if(c&&"bottom"!==c||!u)if(c&&"bottom"!==c||!v)if(c&&"right"===c&&u)f=d(this.chart,i,[{x:i.x+x/2,y:i.y},{x:i.x+x/2,y:n.y-x/2},{x:n.x,y:n.y-x/2},{x:n.x,y:n.y}],b),this.rightStart=!0,a.topEnd=!0,w=i.x+x/2;else if(c&&"right"===c&&v)f=d(this.chart,i,[{x:n.x,y:i.y},{x:n.x,y:n.y}],b),this.rightStart=!0,a.topEnd=!0,w=i.x+x/2;else if(c&&"bottom"===c&&q&&t)f=d(this.chart,j,[{x:j.x,y:j.y+x/2},{x:i.x+x/2,y:j.y+x/2},{x:i.x+x/2,y:n.y-x/2},{x:n.x,y:n.y-x/2},{x:n.x,y:n.y}],b),this.bottomStart=!0,a.topEnd=!0,w=j.x+x/2;else if("left"===c&&q&&t){var z=k.x-x/2;p.x<k.x&&(z=p.x-x/2),f=d(this.chart,k,[{x:z,y:k.y},{x:z,y:n.y-x/2},{x:n.x,y:n.y-x/2},{x:n.x,y:n.y}],b),this.leftStart=!0,a.topEnd=!0,w=k.x}else"left"===c&&(f=d(this.chart,k,[{x:n.x+(k.x-n.x)/2,y:k.y},{x:n.x+(k.x-n.x)/2,y:n.y-x/2},{x:n.x,y:n.y-x/2},{x:n.x,y:n.y}],b),this.leftStart=!0,a.topEnd=!0,w=k.x);else f=d(this.chart,j,[{x:j.x,y:j.y+x/2},{x:j.x+(j.x-n.x)/2,y:j.y+x/2},{x:j.x+(j.x-n.x)/2,y:n.y-x/2},{x:n.x,y:n.y-x/2},{x:n.x,y:n.y}],b),this.bottomStart=!0,a.topEnd=!0,w=j.x+(j.x-n.x)/2;else f=this.leftEnd&&t?d(this.chart,j,[{x:j.x,y:j.y+x/2},{x:j.x+(j.x-n.x)/2,y:j.y+x/2},{x:j.x+(j.x-n.x)/2,y:n.y-x/2},{x:n.x,y:n.y-x/2},{x:n.x,y:n.y}],b):d(this.chart,j,[{x:j.x,y:n.y-x/2},{x:n.x,y:n.y-x/2},{x:n.x,y:n.y}],b),this.bottomStart=!0,a.topEnd=!0,w=j.x+(j.x-n.x)/2;else f=d(this.chart,i,[{x:i.x+x/2,y:i.y},{x:i.x+x/2,y:n.y-x/2},{x:n.x,y:n.y-x/2},{x:n.x,y:n.y}],b),this.rightStart=!0,a.topEnd=!0,w=i.x+x/2;else f=d(this.chart,i,[{x:i.x+x/2,y:i.y},{x:i.x+x/2,y:n.y-x/2},{x:n.x,y:n.y-x/2},{x:n.x,y:n.y}],b),this.rightStart=!0,a.topEnd=!0,w=i.x+x/2;else f=d(this.chart,k,o,b),this.leftStart=!0,a.rightEnd=!0,w=o.x;else f=d(this.chart,i,p,b),this.rightStart=!0,a.leftEnd=!0,w=p.x;else f=d(this.chart,j,n,b),this.bottomStart=!0,a.topEnd=!0,w=j.x;if(f){for(var A=0,B=this.chart.lines.length;B>A;A++)for(var C,D=this.chart.lines[A],E=D.attr("path"),F=f.attr("path"),G=0,H=E.length-1;H>G;G++){var I=[];I.push(["M",E[G][1],E[G][2]]),I.push(["L",E[G+1][1],E[G+1][2]]);for(var J=I[0][1],K=I[0][2],L=I[1][1],M=I[1][2],N=0,O=F.length-1;O>N;N++){var P=[];P.push(["M",F[N][1],F[N][2]]),P.push(["L",F[N+1][1],F[N+1][2]]);var Q=P[0][1],R=P[0][2],S=P[1][1],T=P[1][2],U=e(J,K,L,M,Q,R,S,T);if(U.onLine1&&U.onLine2){var V;R===T?Q>S?(V=["L",U.x+2*y,R],F.splice(N+1,0,V),V=["C",U.x+2*y,R,U.x,R-4*y,U.x-2*y,R],F.splice(N+2,0,V),f.attr("path",F)):(V=["L",U.x-2*y,R],F.splice(N+1,0,V),V=["C",U.x-2*y,R,U.x,R-4*y,U.x+2*y,R],F.splice(N+2,0,V),f.attr("path",F)):R>T?(V=["L",Q,U.y+2*y],F.splice(N+1,0,V),V=["C",Q,U.y+2*y,Q+4*y,U.y,Q,U.y-2*y],F.splice(N+2,0,V),f.attr("path",F)):(V=["L",Q,U.y-2*y],F.splice(N+1,0,V),V=["C",Q,U.y-2*y,Q+4*y,U.y,Q,U.y+2*y],F.splice(N+2,0,V),f.attr("path",F)),N+=2,C+=2}}}this.chart.lines.push(f)}(!this.chart.maxXFromLine||this.chart.maxXFromLine&&w>this.chart.maxXFromLine)&&(this.chart.maxXFromLine=w)},r.inherits(h,g),r.inherits(i,g),r.inherits(j,g),r.inherits(k,g),r.inherits(l,g),l.prototype.getLeft=function(){var a=this.getY()+this.group.getBBox().height/2,b=this.getX()+this.textMargin;return{x:b,y:a}},l.prototype.getRight=function(){var a=this.getY()+this.group.getBBox().height/2,b=this.getX()+this.group.getBBox().width-this.textMargin;return{x:b,y:a}},r.inherits(m,g),m.prototype.render=function(){this.yes_direction&&(this[this.yes_direction+"_symbol"]=this.yes_symbol),this.no_direction&&(this[this.no_direction+"_symbol"]=this.no_symbol);var a=this.getAttr("line-length");if(this.bottom_symbol){var b=this.getBottom();this.bottom_symbol.getTop(),this.bottom_symbol.isPositioned||(this.bottom_symbol.shiftY(this.getY()+this.height+a),this.bottom_symbol.setX(b.x-this.bottom_symbol.width/2),this.bottom_symbol.isPositioned=!0,this.bottom_symbol.render())}if(this.right_symbol){var c=this.getRight();if(this.right_symbol.getLeft(),!this.right_symbol.isPositioned){this.right_symbol.setY(c.y-this.right_symbol.height/2),this.right_symbol.shiftX(this.group.getBBox().x+this.width+a);var d=this;!function e(){for(var b,c=!1,f=0,g=d.chart.symbols.length;g>f;f++){b=d.chart.symbols[f];var h=Math.abs(b.getCenter().x-d.right_symbol.getCenter().x);if(b.getCenter().y>d.right_symbol.getCenter().y&&h<=d.right_symbol.width/2){c=!0;break}}c&&(d.right_symbol.setX(b.getX()+b.width+a),e())}(),this.right_symbol.isPositioned=!0,this.right_symbol.render()}}},m.prototype.renderLines=function(){this.yes_symbol&&this.drawLineTo(this.yes_symbol,this.getAttr("yes-text"),this.yes_direction),this.no_symbol&&this.drawLineTo(this.no_symbol,this.getAttr("no-text"),this.no_direction)},p.parse=n}();
</script>
<script type="text/javascript">
(function (win, doc) {
  function onReady(fn) {
    if (doc.addEventListener) {
      doc.addEventListener('DOMContentLoaded', fn);
    } else {
      doc.attachEvent('onreadystatechange', function() {
        if (doc.readyState === 'interactive')
          fn();
      });
    }
  }

  win.convertUML = function(className, converter, settings) {
    var charts = doc.querySelectorAll("pre." + className),
        arr = [],
        i, j, maxItem, diagaram, text, curNode;

    // Is there a settings object?
    if (settings === void 0) {
        settings = {};
    }

    // Make sure we are dealing with an array
    for(i = 0, maxItem = charts.length; i < maxItem; i++) arr.push(charts[i])

    // Find the UML source element and get the text
    for (i = 0, maxItem = arr.length; i < maxItem; i++) {
        childEl = arr[i].firstChild;
        parentEl = childEl.parentNode;
        text = "";
        for (j = 0; j < childEl.childNodes.length; j++) {
            curNode = childEl.childNodes[j];
            whitespace = /^\s*$/;
            if (curNode.nodeName === "#text" && !(whitespace.test(curNode.nodeValue))) {
                text = curNode.nodeValue;
                break;
            }
        }

        // Do UML conversion and replace source
        el = doc.createElement('div');
        el.className = className;
        parentEl.parentNode.insertBefore(el, parentEl);
        parentEl.parentNode.removeChild(parentEl);
        diagram = converter.parse(text);
        diagram.drawSVG(el, settings);
    }
  }

  onReady(function(){convertUML('uml-flowchart', flowchart);});
  onReady(function(){convertUML('uml-sequence-diagram', Diagram, {theme: 'simple'});});
})(window, document)
</script>
<title>javascript-codechrysalis</title></head><body><article class="markdown-body"><h1 id="code-chrysalis-notes">Code Chrysalis Notes</h1>

<ul>
<li><a href="#1-scopes-and-closures">1. Scopes and Closures</a>
<ul>
<li><a href="#11-definitions">1.1. Definitions</a></li>
<li><a href="#12-basic-examples">1.2. Basic Examples</a></li>
<li><a href="#13-static-(lexical)-vs-dynamic-scoping">1.3. Static (Lexical) vs Dynamic Scoping</a></li>
<li><a href="#14-scoping-examples">1.4. Scoping Examples</a></li>
</ul>
</li>
<li><a href="#2-variable-hoisting">2. Variable Hoisting</a></li>
<li><a href="#3-classes-and-prototypes">3. Classes and Prototypes</a></li>
<li><a href="#4-polymorphism-and-inheritance">4. Polymorphism and Inheritance</a></li>
</ul>

<h1 id="1-scopes-and-closures">1. Scopes and Closures</h1>
<p>Since JavaScript is single threaded, we use callbacks instead of threads. In normal single threaded programming, state is maintained on the stack. Since callbacks are invoked asynchronously, we don’t have that luxury with JavaScript. In languages like Java, if we use a callback we would store state in the this pointer, but JavaScript has issues where the this pointer doesn’t work.</p>
<p>So where do we store state between callbacks? In a <strong>closure</strong>.</p>
<h3 id="11-definitions">1.1. Definitions</h3>
<ul>
<li>A <em><strong>scope</strong></em> defines what variables you have access to. <em>Global variables</em> can be accessed anywhere (global scope), and <em>local variables</em> can only be accessed within the scope of that function (local scope). In other words, a variable's scope is the context in which the variable exist
<ul>
<li>Note: JavaScript does not have <em><strong>block-level scope​</strong></em>, only a <em><strong>Function-level scope</strong></em>, meaning local variables can be created only within a function</li>
</ul>
</li>
<li>A <em><strong>closure</strong></em> is an anonymous scope created by the JavaScript runtime when a variable from an outer-scope is referenced from an inner scope.</li>
</ul>
<h3 id="12-basic-examples">1.2. Basic Examples</h3>
<p><strong>Example: Scope</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">const</span> <span class="pl-c1">student</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Hiroki<span class="pl-pds">'</span></span>; <span class="pl-c"><span class="pl-c">//</span> &lt;-- global scope</span>

<span class="pl-k">function</span> <span class="pl-en">sayStudentName</span>() {
  <span class="pl-k">const</span> <span class="pl-c1">student</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>Mia<span class="pl-pds">'</span></span>; <span class="pl-c"><span class="pl-c">//</span> &lt;-- local scope</span>
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(student, <span class="pl-s"><span class="pl-pds">'</span>is in the local scope<span class="pl-pds">'</span></span>);
}

<span class="pl-en">console</span>.<span class="pl-c1">log</span>(student, <span class="pl-s"><span class="pl-pds">'</span>is in the global scope<span class="pl-pds">'</span></span>); <span class="pl-c"><span class="pl-c">//</span> Hiroki is in the global scope</span>
<span class="pl-en">sayStudentName</span>(); <span class="pl-c"><span class="pl-c">//</span> Mia is in the local scope</span></pre></div>
<ul>
<li><code>Mia</code> is not accessible to anything outside of <code>sayStudentName()</code></li>
<li><code>sayStudentName()</code> has access to both <code>Hiroki</code> and <code>Mia</code> for the variable <code>student</code> (chooses the more local variable)</li>
<li><strong>Closures</strong> are an extension of this concept
<ul>
<li><strong>A closure is a function within another function that remembers the information in its global and local scope</strong></li>
<li>A closure is a function within another function that also <strong>remembers the environment in which it was created</strong></li>
<li>It helps us store information we want to keep <em>private</em> (use underscore in your code to indicate a private variable)</li>
</ul>
</li>
</ul>
<p><strong>Example: Closure</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> age calculator</span>
<span class="pl-k">let</span> birthYear <span class="pl-k">=</span> <span class="pl-c1">1991</span>;

<span class="pl-k">function</span> <span class="pl-en">ageDifference</span>(<span class="pl-smi">yearInput</span>) {
  <span class="pl-k">return</span> yearInput <span class="pl-k">-</span> birthYear;
}

<span class="pl-c"><span class="pl-c">//</span> change it so that birthYear can't be accessed globally</span>
<span class="pl-c"><span class="pl-c">//</span> wrap the 'ageDifference' inside of another function called 'ageCalculator'</span>
<span class="pl-k">function</span> <span class="pl-en">ageCalculator</span>(<span class="pl-smi">_birthYear</span>) {
  <span class="pl-k">return</span> <span class="pl-k">function</span> <span class="pl-en">ageDifference</span>(<span class="pl-smi">yearInput</span>) {
    <span class="pl-k">return</span> yearInput <span class="pl-k">-</span> _birthYear;
  };
}

<span class="pl-k">const</span> <span class="pl-c1">calculateMiaAge</span> <span class="pl-k">=</span> <span class="pl-en">ageCalculator</span>(<span class="pl-c1">1991</span>);
<span class="pl-k">const</span> <span class="pl-c1">calculateHirokiAge</span> <span class="pl-k">=</span> <span class="pl-en">ageCalculator</span>(<span class="pl-c1">1972</span>);

<span class="pl-en">calculateMiaAge</span>(<span class="pl-c1">2020</span>); <span class="pl-c"><span class="pl-c">//</span> 29</span>
<span class="pl-en">calculateHirokiAge</span>(<span class="pl-c1">2020</span>); <span class="pl-c"><span class="pl-c">//</span> 48</span>

<span class="pl-en">calculateMiaAge</span>(<span class="pl-c1">2023</span>); <span class="pl-c"><span class="pl-c">//</span> 32</span>
<span class="pl-en">calculateHirokiAge</span>(<span class="pl-c1">2023</span>); <span class="pl-c"><span class="pl-c">//</span> 51</span></pre></div>
<ul>
<li>The inner function has access not only to the outer function’s variables, but also to the outer function’s parameters.</li>
<li>Note that the inner function cannot call the outer function’s <code>arguments</code> object, however</li>
</ul>
<p><strong>Example:</strong> Closures store <strong>references</strong> to the outer function's variables (not the actual value)</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">celebrityID</span> () {
  <span class="pl-k">var</span> celebrityID <span class="pl-k">=</span> <span class="pl-c1">999</span>;
  <span class="pl-c"><span class="pl-c">//</span> We are returning an object with some inner functions​</span>
  <span class="pl-c"><span class="pl-c">//</span> All the inner functions have access to the outer function's variables​</span>
  <span class="pl-k">return</span> {
    <span class="pl-en">getID</span><span class="pl-k">:</span> <span class="pl-k">function</span> ()  {
      <span class="pl-c"><span class="pl-c">//</span> This inner function will return the UPDATED celebrityID variable​</span>
      <span class="pl-c"><span class="pl-c">//</span> It will return the current value of celebrityID, even after the changeTheID function changes it​</span>
      <span class="pl-k">return</span> celebrityID;
    },
    <span class="pl-en">setID</span><span class="pl-k">:</span> <span class="pl-k">function</span> (<span class="pl-smi">theNewID</span>)  {
      <span class="pl-c"><span class="pl-c">//</span> This inner function will change the outer function's variable anytime​</span>
      celebrityID <span class="pl-k">=</span> theNewID;
    }
  }
​}
​
​<span class="pl-k">var</span> mjID <span class="pl-k">=</span> <span class="pl-en">celebrityID</span> (); <span class="pl-c"><span class="pl-c">//</span> At this juncture, the celebrityID outer function has returned.​</span>
<span class="pl-smi">mjID</span>.<span class="pl-en">getID</span>(); <span class="pl-c"><span class="pl-c">//</span> 999​</span>
<span class="pl-smi">mjID</span>.<span class="pl-en">setID</span>(<span class="pl-c1">567</span>); <span class="pl-c"><span class="pl-c">//</span> Changes the outer function's variable​</span>
<span class="pl-smi">mjID</span>.<span class="pl-en">getID</span>(); <span class="pl-c"><span class="pl-c">//</span> 567: It returns the updated celebrityId variable </span></pre></div>
<h3 id="13-static-lexical-vs-dynamic-scoping">1.3. Static (Lexical) vs Dynamic Scoping</h3>
<p><a href="https://medium.freecodecamp.org/lets-learn-javascript-closures-66feb44f6a44" rel="nofollow">https://medium.freecodecamp.org/lets-learn-javascript-closures-66feb44f6a44</a></p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> myVar <span class="pl-k">=</span> <span class="pl-c1">100</span>;
 
<span class="pl-k">function</span> <span class="pl-en">foo</span>() {
  <span class="pl-en">console</span>.<span class="pl-c1">log</span>(myVar);
}
 
<span class="pl-en">foo</span>(); <span class="pl-c"><span class="pl-c">//</span> Static scope: 100; Dynamic scope: 100</span>
 
(<span class="pl-k">function</span> () {
  <span class="pl-k">var</span> myVar <span class="pl-k">=</span> <span class="pl-c1">50</span>;
  <span class="pl-en">foo</span>(); <span class="pl-c"><span class="pl-c">//</span> Static scope: 100; Dynamic scope: 50</span>
})();

<span class="pl-c"><span class="pl-c">//</span> Higher-order function</span>
(<span class="pl-k">function</span> (<span class="pl-smi">arg</span>) {
  <span class="pl-k">var</span> myVar <span class="pl-k">=</span> <span class="pl-c1">1500</span>;
  <span class="pl-en">arg</span>();  <span class="pl-c"><span class="pl-c">//</span> Static scope: 100; Dynamic scope: 1500</span>
})(foo);</pre></div>
<ul>
<li>In the <strong>dynamic scope</strong> example above the variable <code>myVar</code> is resolved using the value of <code>myVar</code> <strong>at the place</strong> where the function is <strong>called</strong> (<em>at runtime</em>).</li>
<li><strong>Static scope</strong>, on the other hand, resolves <code>myVar</code> to the variable that was saved <strong>in the scope</strong> of the two IIFE functions <em>at creation</em>. In other words, it is defined statically by <strong>its location within the source code</strong>.</li>
<li>The scope of closure in JavaScript is lexcial (static).</li>
</ul>
<h3 id="14-scoping-examples">1.4. Scoping Examples</h3>
<p><strong>Example 1:</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> canonical mistake</span>
<span class="pl-k">var</span> result <span class="pl-k">=</span> [];
 
<span class="pl-k">for</span> (<span class="pl-k">var</span> i <span class="pl-k">=</span> <span class="pl-c1">0</span>; i <span class="pl-k">&lt;</span> <span class="pl-c1">5</span>; i<span class="pl-k">++</span>) {
  result[i] <span class="pl-k">=</span> <span class="pl-k">function</span> () {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(i);
  };
}

result[<span class="pl-c1">0</span>](); <span class="pl-c"><span class="pl-c">//</span> 5, expected 0</span>
result[<span class="pl-c1">1</span>](); <span class="pl-c"><span class="pl-c">//</span> 5, expected 1</span>
result[<span class="pl-c1">2</span>](); <span class="pl-c"><span class="pl-c">//</span> 5, expected 2</span>
result[<span class="pl-c1">3</span>](); <span class="pl-c"><span class="pl-c">//</span> 5, expected 3</span>
result[<span class="pl-c1">4</span>](); <span class="pl-c"><span class="pl-c">//</span> 5, expected 4</span></pre></div>
<p>Abstractly, here’s what the environment looks like by the time the for-loop exits</p>
<div class="highlight highlight-source-js"><pre>environment<span class="pl-k">:</span> {
  EnvironmentRecord<span class="pl-k">:</span> {
    result<span class="pl-k">:</span> [<span class="pl-k">...</span>],
    i<span class="pl-k">:</span> <span class="pl-c1">5</span>
  },
  outer<span class="pl-k">:</span> <span class="pl-c1">null</span>,
}
<span class="pl-c"><span class="pl-c">//</span> environment is the same for all 5 functions:</span>
<span class="pl-c"><span class="pl-c">//</span> every time the variable i is incremented, it updates scope, which is shared by all the functions</span></pre></div>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> One way to fix this: create an additional enclosing context for each function</span>
<span class="pl-k">var</span> result <span class="pl-k">=</span> [];
 
<span class="pl-k">for</span> (<span class="pl-k">var</span> i <span class="pl-k">=</span> <span class="pl-c1">0</span>; i <span class="pl-k">&lt;</span> <span class="pl-c1">5</span>; i<span class="pl-k">++</span>) {
  result[i] <span class="pl-k">=</span> (<span class="pl-k">function</span> <span class="pl-en">inner</span>(<span class="pl-smi">x</span>) {
    <span class="pl-c"><span class="pl-c">//</span> additional enclosing context</span>
    <span class="pl-k">return</span> <span class="pl-k">function</span>() {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(x);
    }
  })(i);
}

result[<span class="pl-c1">0</span>](); <span class="pl-c"><span class="pl-c">//</span> 0, expected 0</span>
result[<span class="pl-c1">1</span>](); <span class="pl-c"><span class="pl-c">//</span> 1, expected 1</span>
result[<span class="pl-c1">2</span>](); <span class="pl-c"><span class="pl-c">//</span> 2, expected 2</span>
result[<span class="pl-c1">3</span>](); <span class="pl-c"><span class="pl-c">//</span> 3, expected 3</span>
result[<span class="pl-c1">4</span>](); <span class="pl-c"><span class="pl-c">//</span> 4, expected 4</span></pre></div>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> Another way: use let instead of var, since let is block-scoped</span>
<span class="pl-c"><span class="pl-c">//</span> and so a new identifier binding is created for each iteration in the for-loop</span>
<span class="pl-k">var</span> result <span class="pl-k">=</span> [];
 
<span class="pl-k">for</span> (<span class="pl-k">let</span> i <span class="pl-k">=</span> <span class="pl-c1">0</span>; i <span class="pl-k">&lt;</span> <span class="pl-c1">5</span>; i<span class="pl-k">++</span>) {
  result[i] <span class="pl-k">=</span> <span class="pl-k">function</span> () {
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(i);
  };
}

result[<span class="pl-c1">0</span>](); <span class="pl-c"><span class="pl-c">//</span> 0, expected 0</span>
result[<span class="pl-c1">1</span>](); <span class="pl-c"><span class="pl-c">//</span> 1, expected 1</span>
result[<span class="pl-c1">2</span>](); <span class="pl-c"><span class="pl-c">//</span> 2, expected 2</span>
result[<span class="pl-c1">3</span>](); <span class="pl-c"><span class="pl-c">//</span> 3, expected 3</span>
result[<span class="pl-c1">4</span>](); <span class="pl-c"><span class="pl-c">//</span> 4, expected 4</span></pre></div>
<p><strong>Example 2:</strong> Each <em>call</em> to a function creates a new separate closure</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">iCantThinkOfAName</span>(<span class="pl-smi">num</span>, <span class="pl-smi">obj</span>) {
  <span class="pl-c"><span class="pl-c">//</span> This array variable, along with the 2 parameters passed in, </span>
  <span class="pl-c"><span class="pl-c">//</span> are 'captured' by the nested function 'doSomething'</span>
  <span class="pl-k">var</span> array <span class="pl-k">=</span> [<span class="pl-c1">1</span>, <span class="pl-c1">2</span>, <span class="pl-c1">3</span>];
  <span class="pl-k">function</span> <span class="pl-en">doSomething</span>(<span class="pl-smi">i</span>) {
    num <span class="pl-k">+=</span> i;
    <span class="pl-smi">array</span>.<span class="pl-c1">push</span>(num);
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>num: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> num);
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>array: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> array);
    <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>obj.value: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">obj</span>.<span class="pl-c1">value</span>);
  }
  
  <span class="pl-k">return</span> doSomething;
}

<span class="pl-k">var</span> referenceObject <span class="pl-k">=</span> { value<span class="pl-k">:</span> <span class="pl-c1">10</span> };
<span class="pl-k">var</span> foo <span class="pl-k">=</span> <span class="pl-en">iCantThinkOfAName</span>(<span class="pl-c1">2</span>, referenceObject); <span class="pl-c"><span class="pl-c">//</span> closure #1</span>
<span class="pl-k">var</span> bar <span class="pl-k">=</span> <span class="pl-en">iCantThinkOfAName</span>(<span class="pl-c1">6</span>, referenceObject); <span class="pl-c"><span class="pl-c">//</span> closure #2</span>

<span class="pl-en">foo</span>(<span class="pl-c1">2</span>); 
<span class="pl-c"><span class="pl-c">/*</span></span>
<span class="pl-c">  num: 4</span>
<span class="pl-c">  array: 1,2,3,4</span>
<span class="pl-c">  obj.value: 10</span>
<span class="pl-c"><span class="pl-c">*/</span></span>

<span class="pl-en">bar</span>(<span class="pl-c1">2</span>); 
<span class="pl-c"><span class="pl-c">/*</span></span>
<span class="pl-c">  num: 8</span>
<span class="pl-c">  array: 1,2,3,8</span>
<span class="pl-c">  obj.value: 10</span>
<span class="pl-c"><span class="pl-c">*/</span></span>

<span class="pl-smi">referenceObject</span>.<span class="pl-c1">value</span><span class="pl-k">++</span>;

<span class="pl-en">foo</span>(<span class="pl-c1">4</span>);
<span class="pl-c"><span class="pl-c">/*</span></span>
<span class="pl-c">  num: 8</span>
<span class="pl-c">  array: 1,2,3,4,8</span>
<span class="pl-c">  obj.value: 11</span>
<span class="pl-c"><span class="pl-c">*/</span></span>

<span class="pl-en">bar</span>(<span class="pl-c1">4</span>); 
<span class="pl-c"><span class="pl-c">/*</span></span>
<span class="pl-c">  num: 12</span>
<span class="pl-c">  array: 1,2,3,8,12</span>
<span class="pl-c">  obj.value: 11</span>
<span class="pl-c"><span class="pl-c">*/</span></span></pre></div>
<p><strong>Example 3:</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">mysteriousCalculator</span>(<span class="pl-smi">a</span>, <span class="pl-smi">b</span>) {
  <span class="pl-k">var</span> mysteriousVariable <span class="pl-k">=</span> <span class="pl-c1">3</span>;
  <span class="pl-k">return</span> {
    <span class="pl-en">add</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
      <span class="pl-k">var</span> result <span class="pl-k">=</span> a <span class="pl-k">+</span> b <span class="pl-k">+</span> mysteriousVariable;
      <span class="pl-k">return</span> <span class="pl-en">toFixedTwoPlaces</span>(result);
    },
    
    <span class="pl-en">subtract</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
      <span class="pl-k">var</span> result <span class="pl-k">=</span> a <span class="pl-k">-</span> b <span class="pl-k">-</span> mysteriousVariable;
      <span class="pl-k">return</span> <span class="pl-en">toFixedTwoPlaces</span>(result);
    }
  }
}

<span class="pl-k">function</span> <span class="pl-en">toFixedTwoPlaces</span>(<span class="pl-smi">value</span>) {
  <span class="pl-k">return</span> <span class="pl-smi">value</span>.<span class="pl-en">toFixed</span>(<span class="pl-c1">2</span>);
}

<span class="pl-k">var</span> myCalculator <span class="pl-k">=</span> <span class="pl-en">mysteriousCalculator</span>(<span class="pl-c1">10.01</span>, <span class="pl-c1">2.01</span>);
<span class="pl-smi">myCalculator</span>.<span class="pl-c1">add</span>() <span class="pl-c"><span class="pl-c">//</span> 15.02</span>
<span class="pl-smi">myCalculator</span>.<span class="pl-en">subtract</span>() <span class="pl-c"><span class="pl-c">//</span> 5.00</span></pre></div>
<p>Abstractly, the environments for the example above look like this</p>
<div class="highlight highlight-source-js"><pre>GlobalEnvironment <span class="pl-k">=</span> {
  EnvironmentRecord<span class="pl-k">:</span> { 
    <span class="pl-c"><span class="pl-c">//</span> built-in identifiers</span>
    <span class="pl-c1">Array</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;func&gt;<span class="pl-pds">'</span></span>,
    <span class="pl-c1">Object</span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;func&gt;<span class="pl-pds">'</span></span>,
    <span class="pl-c"><span class="pl-c">//</span> etc...</span>

    <span class="pl-c"><span class="pl-c">//</span> custom identifiers</span>
    mysteriousCalculator<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;func&gt;<span class="pl-pds">'</span></span>,
    toFixedTwoPlaces<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>&lt;func&gt;<span class="pl-pds">'</span></span>,
  },
  outer<span class="pl-k">:</span> <span class="pl-c1">null</span>,
};
 
mysteriousCalculatorEnvironment <span class="pl-k">=</span> {
  EnvironmentRecord<span class="pl-k">:</span> {
    a<span class="pl-k">:</span> <span class="pl-c1">10.01</span>,
    b<span class="pl-k">:</span> <span class="pl-c1">2.01</span>,  
    mysteriousVariable<span class="pl-k">:</span> <span class="pl-c1">3</span>,
  }
  outer<span class="pl-k">:</span> GlobalEnvironment,
};

addEnvironment <span class="pl-k">=</span> {
  EnvironmentRecord<span class="pl-k">:</span> {
    result<span class="pl-k">:</span> <span class="pl-c1">15.02</span>
  }
  outer<span class="pl-k">:</span> mysteriousCalculatorEnvironment,
};

subtractEnvironment <span class="pl-k">=</span> {
  EnvironmentRecord<span class="pl-k">:</span> {
    result<span class="pl-k">:</span> <span class="pl-c1">5.00</span>
  }
  outer<span class="pl-k">:</span> mysteriousCalculatorEnvironment,
};</pre></div>
<p><strong>Example 4:</strong> demonstrate an important use of closures: to maintain a <strong>private reference</strong> to a variable in the outer scope.</p>
<ul>
<li>This is a very powerful technique — it gives the closure function <code>guessPassword</code> exclusive access to the <code>password</code> variable, while making it impossible to access the <code>password</code> from the outside.</li>
</ul>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">secretPassword</span>() {
  <span class="pl-k">var</span> password <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>xh38sk<span class="pl-pds">'</span></span>;
  <span class="pl-k">return</span> {
    <span class="pl-en">guessPassword</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">guess</span>) {
      <span class="pl-k">if</span> (guess <span class="pl-k">===</span> password) {
        <span class="pl-k">return</span> <span class="pl-c1">true</span>;
      } <span class="pl-k">else</span> {
        <span class="pl-k">return</span> <span class="pl-c1">false</span>;
      }
    }
  }
}

<span class="pl-k">var</span> passwordGame <span class="pl-k">=</span> <span class="pl-en">secretPassword</span>();
<span class="pl-smi">passwordGame</span>.<span class="pl-en">guessPassword</span>(<span class="pl-s"><span class="pl-pds">'</span>heyisthisit?<span class="pl-pds">'</span></span>); <span class="pl-c"><span class="pl-c">//</span> false</span>
<span class="pl-smi">passwordGame</span>.<span class="pl-en">guessPassword</span>(<span class="pl-s"><span class="pl-pds">'</span>xh38sk<span class="pl-pds">'</span></span>); <span class="pl-c"><span class="pl-c">//</span> true</span></pre></div>
<p><strong>Example 5</strong>: <code>setTimeout</code> variables are executed in the global scope</p>
<ul>
<li>The use of the <code>this</code> object inside the <code>setTimeout</code> function refers to the <code>Window</code> object, not to <code>myObj​</code></li>
</ul>
<div class="highlight highlight-source-js"><pre>​<span class="pl-k">var</span> highValue <span class="pl-k">=</span> <span class="pl-c1">200</span>;
​<span class="pl-k">var</span> constantVal <span class="pl-k">=</span> <span class="pl-c1">2</span>;
​<span class="pl-k">var</span> myObj <span class="pl-k">=</span> {
  highValue<span class="pl-k">:</span> <span class="pl-c1">20</span>,
  constantVal<span class="pl-k">:</span> <span class="pl-c1">5</span>,
  <span class="pl-en">calculateIt</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
    <span class="pl-c1">setTimeout</span>(<span class="pl-k">function</span>() {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-c1">this</span>.<span class="pl-smi">constantVal</span> <span class="pl-k">*</span> <span class="pl-c1">this</span>.<span class="pl-smi">highValue</span>);
    }, <span class="pl-c1">2000</span>)
  }
}
​
​<span class="pl-c"><span class="pl-c">//</span> The "this" object in the setTimeout function used the global highValue and constantVal variables,</span>
<span class="pl-c"><span class="pl-c">//</span> because the reference to "this" in the setTimeout function refers to the global window object,</span>
<span class="pl-c"><span class="pl-c">//</span> not to the myObj object as we might expect.​</span>
<span class="pl-smi">myObj</span>.<span class="pl-en">calculateIt</span>(); <span class="pl-c"><span class="pl-c">//</span> 400​</span>
​<span class="pl-c"><span class="pl-c">//</span> This is an important point to remember.</span></pre></div>
<h1 id="2-variable-hoisting">2. Variable Hoisting</h1>
<p><a href="http://javascriptissexy.com/javascript-variable-scope-and-hoisting-explained/" rel="nofollow">http://javascriptissexy.com/javascript-variable-scope-and-hoisting-explained/</a></p>
<ul>
<li>All variable declarations are hoisted (lifted and declared) to the top of the function, if defined in a function, or the top of the global context, if outside a function.</li>
<li>It is important to know that only <strong>variable declarations</strong> are hoisted to the top, NOT <em>variable initialization</em> or <em>assignments</em> (when the variable is assigned a value).</li>
</ul>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">showName</span> () {
<span class="pl-en">console</span>.<span class="pl-c1">log</span> (<span class="pl-s"><span class="pl-pds">"</span>First Name: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> name);
​<span class="pl-k">var</span> name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Ford<span class="pl-pds">"</span></span>;
<span class="pl-en">console</span>.<span class="pl-c1">log</span> (<span class="pl-s"><span class="pl-pds">"</span>Last Name: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> name);
}
​
<span class="pl-en">showName</span> (); 
​<span class="pl-c"><span class="pl-c">//</span> First Name: undefined​</span>
​<span class="pl-c"><span class="pl-c">//</span> Last Name: Ford​</span>
​
​<span class="pl-c"><span class="pl-c">//</span> The reason undefined prints first is because the local variable 'name' was hoisted</span>
<span class="pl-c"><span class="pl-c">//</span> to the top of the function​</span>
​<span class="pl-c"><span class="pl-c">//</span> Which means it is this local variable that get calls the first time.​</span>

​<span class="pl-c"><span class="pl-c">//</span> This is how the code is actually processed by the JavaScript engine:​</span>
​<span class="pl-k">function</span> <span class="pl-en">showName</span> () {
  <span class="pl-k">var</span> name; <span class="pl-c"><span class="pl-c">//</span> name is hoisted (note that is undefined at this point, since the assignment happens below)​</span>
<span class="pl-en">console</span>.<span class="pl-c1">log</span> (<span class="pl-s"><span class="pl-pds">"</span>First Name: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> name); <span class="pl-c"><span class="pl-c">//</span> First Name: undefined​</span>
​
name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Ford<span class="pl-pds">"</span></span>; <span class="pl-c"><span class="pl-c">//</span> name is assigned a value​</span>
​
​<span class="pl-c"><span class="pl-c">//</span> now name is Ford​</span>
<span class="pl-en">console</span>.<span class="pl-c1">log</span> (<span class="pl-s"><span class="pl-pds">"</span>Last Name: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> name); <span class="pl-c"><span class="pl-c">//</span> Last Name: Ford​</span>
}</pre></div>
<ul>
<li>Both function declaration and variable declarations are hoisted to the top of the containing scope.
<ul>
<li>Function declaration takes precedence over variable declarations (but NOT over variable assignment)</li>
</ul>
</li>
</ul>
<div class="highlight highlight-source-js"><pre> <span class="pl-c"><span class="pl-c">//</span> Both the variable and the function are named myName​</span>
​<span class="pl-k">var</span> myName;

​<span class="pl-k">function</span> <span class="pl-en">myName</span>() {
  <span class="pl-en">console</span>.<span class="pl-c1">log</span> (<span class="pl-s"><span class="pl-pds">"</span>Rich<span class="pl-pds">"</span></span>);
}
​
​<span class="pl-c"><span class="pl-c">//</span> The function declaration overrides the variable 'name'​</span>
<span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-k">typeof</span> myName); <span class="pl-c"><span class="pl-c">//</span> function</span></pre></div>
<div class="highlight highlight-source-js"><pre> <span class="pl-c"><span class="pl-c">//</span> But in this example, the variable assignment overrides the function declaration​</span>
​<span class="pl-k">var</span> myName <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Richard<span class="pl-pds">"</span></span>; <span class="pl-c"><span class="pl-c">//</span> Variable assignment (initialization)</span>
​
​<span class="pl-k">function</span> <span class="pl-en">myName</span> () {
  <span class="pl-en">console</span>.<span class="pl-c1">log</span> (<span class="pl-s"><span class="pl-pds">"</span>Rich<span class="pl-pds">"</span></span>);
}
​
<span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-k">typeof</span> myName); <span class="pl-c"><span class="pl-c">//</span> string </span></pre></div>
<ul>
<li>It is important to note that function expressions (function assignment), such as the example below, are not hoisted</li>
</ul>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> <span class="pl-en">myName</span> <span class="pl-k">=</span> <span class="pl-k">function</span> () {
  <span class="pl-en">console</span>.<span class="pl-c1">log</span> (<span class="pl-s"><span class="pl-pds">"</span>Rich<span class="pl-pds">"</span></span>);
} </pre></div>
<ul>
<li>In strict mode, an error will occur if you assign a variable a value without first declaring the variable. Always declare your variables.</li>
</ul>
<h1 id="3-classes-and-prototypes">3. Classes and Prototypes</h1>
<p><strong>How to construct classes in JS</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> ES6: 'class' and 'constructor' keywords</span>
<span class="pl-k">class</span> <span class="pl-en">Car</span> {
  <span class="pl-en">constructor</span>() {
      <span class="pl-c1">this</span>.<span class="pl-smi">gas</span> <span class="pl-k">=</span> <span class="pl-c1">1.0</span>;
      <span class="pl-c1">this</span>.<span class="pl-smi">brake</span> <span class="pl-k">=</span> <span class="pl-c1">0.0</span>;
      <span class="pl-c1">this</span>.<span class="pl-smi">odometer</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;
  }
  
  <span class="pl-en">drive</span>() {
    <span class="pl-c1">this</span>.<span class="pl-smi">brake</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;
    <span class="pl-c1">this</span>.<span class="pl-smi">gas</span> <span class="pl-k">=</span> <span class="pl-c1">1.0</span>;
    <span class="pl-c1">this</span>.<span class="pl-smi">odometer</span> <span class="pl-k">+=</span> <span class="pl-c1">10</span>;
  }
  
  <span class="pl-en">stop</span>() {
    <span class="pl-c1">this</span>.<span class="pl-smi">gas</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;
    <span class="pl-c1">this</span>.<span class="pl-smi">brake</span> <span class="pl-k">=</span> <span class="pl-c1">1.0</span>;
  }
  
  <span class="pl-en">readOdometer</span>() {
    <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">odometer</span>;
  }
}</pre></div>
<p><strong>Instantiation</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> carA <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Car</span>();
<span class="pl-k">var</span> carB <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Car</span>();

<span class="pl-smi">carA</span>.<span class="pl-en">drive</span>();
<span class="pl-smi">carA</span>.<span class="pl-en">readOdometer</span>();

<span class="pl-smi">carB</span>.<span class="pl-en">drive</span>();
<span class="pl-smi">carB</span>.<span class="pl-en">drive</span>();
<span class="pl-smi">carB</span>.<span class="pl-en">readOdometer</span>();</pre></div>
<p><strong>Under the hood</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">&gt;</span> <span class="pl-smi">carA</span>.<span class="pl-en">hasOwnProperty</span>(<span class="pl-s"><span class="pl-pds">'</span>drive<span class="pl-pds">'</span></span>)
<span class="pl-c1">false</span>

<span class="pl-c"><span class="pl-c">//</span> '__proto__' is the property on an object that points to the prototype that has been set for that object</span>
<span class="pl-k">&gt;</span> <span class="pl-smi">carA</span>.<span class="pl-smi">__proto__</span>
Car {}

<span class="pl-k">&gt;</span> <span class="pl-smi">carA</span>.<span class="pl-smi">__proto__</span>.<span class="pl-smi">drive</span>
[<span class="pl-c1">Function</span><span class="pl-k">:</span> drive]

<span class="pl-c"><span class="pl-c">//</span> 'prototype' is a property on a function and it is set if you're using the 'new' keyword</span>
<span class="pl-k">&gt;</span> <span class="pl-k">typeof</span> Car
<span class="pl-s"><span class="pl-pds">'</span>function<span class="pl-pds">'</span></span> <span class="pl-c"><span class="pl-c">//</span> Car is a function</span>

<span class="pl-k">&gt;</span> <span class="pl-smi">Car</span>.<span class="pl-c1">prototype</span> <span class="pl-c"><span class="pl-c">//</span> Functions have prototype Objects</span>
Car {}

<span class="pl-k">&gt;</span> <span class="pl-smi">Car</span>.<span class="pl-c1">prototype</span>.<span class="pl-smi">drive</span> <span class="pl-c"><span class="pl-c">//</span> The class keyword adds the methods to the prototype</span>
[<span class="pl-c1">Function</span><span class="pl-k">:</span> drive]</pre></div>
<p><strong>Breaking it down</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> classes are really just constructor functions with 'prototype' members</span>
<span class="pl-k">&gt;</span> <span class="pl-k">typeof</span> Car
<span class="pl-s"><span class="pl-pds">'</span>function<span class="pl-pds">'</span></span>

<span class="pl-c"><span class="pl-c">//</span> same as using 'class' and 'constructor' keywords</span>
<span class="pl-c"><span class="pl-c">//</span> ES5 code</span>
<span class="pl-k">var</span> <span class="pl-en">Car</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() { 
      <span class="pl-c1">this</span>.<span class="pl-smi">gas</span> <span class="pl-k">=</span> <span class="pl-c1">1.0</span>;
      <span class="pl-c1">this</span>.<span class="pl-smi">brake</span> <span class="pl-k">=</span> <span class="pl-c1">0.0</span>;
      <span class="pl-c1">this</span>.<span class="pl-smi">odometer</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;
};

<span class="pl-smi">Car</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">drive</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() { 
    <span class="pl-c1">this</span>.<span class="pl-smi">brake</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;
    <span class="pl-c1">this</span>.<span class="pl-smi">gas</span> <span class="pl-k">=</span> <span class="pl-c1">1.0</span>;
    <span class="pl-c1">this</span>.<span class="pl-smi">odometer</span> <span class="pl-k">+=</span> <span class="pl-c1">10</span>;
}
<span class="pl-smi">Car</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">stop</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() { 
    <span class="pl-c1">this</span>.<span class="pl-smi">gas</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;
    <span class="pl-c1">this</span>.<span class="pl-smi">brake</span> <span class="pl-k">=</span> <span class="pl-c1">1.0</span>;
}
<span class="pl-smi">Car</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">readOdometer</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() { 
    <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">odometer</span>;
}

<span class="pl-k">var</span> carA <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Car</span>();
<span class="pl-k">var</span> carB <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Car</span>();</pre></div>
<h1 id="4-polymorphism-and-inheritance">4. Polymorphism and Inheritance</h1>
<p><strong>Create a <em>super class</em></strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">class</span> <span class="pl-en">MusicPlayer</span> {
  <span class="pl-en">constructor</span>() {
    <span class="pl-c1">this</span>.<span class="pl-smi">time</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;
    <span class="pl-c1">this</span>.<span class="pl-smi">timer</span> <span class="pl-k">=</span> <span class="pl-c1">undefined</span>;
    <span class="pl-c1">this</span>.<span class="pl-smi">tick</span> <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-smi">tick</span>.<span class="pl-en">bind</span>(<span class="pl-c1">this</span>);
  }
  
  <span class="pl-en">tick</span>() {
    <span class="pl-c1">this</span>.<span class="pl-smi">time</span><span class="pl-k">++</span>;
  }
  
  <span class="pl-en">play</span>() {
    <span class="pl-c1">setInterval</span>(<span class="pl-c1">this</span>.<span class="pl-smi">tick</span>, <span class="pl-c1">1000</span>);
  }
  
  <span class="pl-en">stop</span>() {
    <span class="pl-c1">clearInterval</span>(<span class="pl-c1">this</span>.<span class="pl-smi">tick</span>);
  }
  
  <span class="pl-en">getTime</span>() {
    <span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-smi">time</span>;
  }
}</pre></div>
<p><strong>Create different <em>sub classes</em></strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">class</span> <span class="pl-en">RecordPlayer</span> <span class="pl-k">extends</span> <span class="pl-e">MusicPlayer</span> {
  <span class="pl-en">play</span>() { <span class="pl-c"><span class="pl-c">//</span> &lt;-- overrides methods from super class</span>
    <span class="pl-c1">super</span>.<span class="pl-c1">play</span>();
    <span class="pl-c1">this</span>.<span class="pl-en">positionNeedle</span>();
    <span class="pl-c1">this</span>.<span class="pl-en">startRotation</span>();
  }
  
  <span class="pl-en">stop</span>() {
    <span class="pl-c1">super</span>.<span class="pl-c1">stop</span>();
    <span class="pl-c1">this</span>.<span class="pl-en">resetNeedle</span>();
    <span class="pl-c1">this</span>.<span class="pl-en">stopRotation</span>();
  }
} </pre></div>
<div class="highlight highlight-source-js"><pre><span class="pl-k">class</span> <span class="pl-en">CassettePlayer</span> <span class="pl-k">extends</span> <span class="pl-e">MusicPlayer</span> {
  <span class="pl-en">play</span>() {
    <span class="pl-c1">super</span>.<span class="pl-c1">play</span>();
    <span class="pl-c1">this</span>.<span class="pl-en">startMotor</span>();
  }
  
  <span class="pl-en">stop</span>() {
    <span class="pl-c1">super</span>.<span class="pl-c1">stop</span>();
    <span class="pl-c1">this</span>.<span class="pl-en">stopMotor</span>();
  }
} </pre></div>
<p><strong><em>Prototype chaining</em></strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> myPlayer <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">CassettePlayer</span>();
<span class="pl-smi">myPlayer</span>.<span class="pl-c1">start</span>();
<span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-smi">myPlayer</span>.<span class="pl-c1">getTime</span>());</pre></div>
<p>Internally JavaScript will resolve <code>getTime()</code> using the following steps:</p>
<ol>
<li>look for <code>myPlayer.getTime()</code> → won't find it</li>
<li>check <code>myPlayer.__proto__.getTime()</code> which will refer to <code>CassettePlayer</code> → won't find it</li>
<li>It will check <code>myPlayer.__proto__.__proto__.getTime()</code>, which refers to <code>MusicPlayer</code> → does have the method, it will <code>call()</code> that method using <code>this = myPlayer</code></li>
</ol>
<p>This allows us to re-use common code, by implementing it on a <em>super class</em>, but refine that behavior on <em>sub classes</em>. This principle is called <strong><em>polymorphism</em></strong>.</p>
<p><strong><em>Constructor Chaining</em></strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">class</span> <span class="pl-en">CdPlayer</span> {
  <span class="pl-en">constructor</span>(<span class="pl-smi">cd</span>) {
    <span class="pl-c1">super</span>(); <span class="pl-c"><span class="pl-c">//</span> required to be on 1st line</span>
    <span class="pl-c1">this</span>.<span class="pl-smi">cd</span> <span class="pl-k">=</span> cd;
  }  
  
  <span class="pl-en">getTrack</span>() {
    <span class="pl-k">return</span> <span class="pl-smi">cd</span>.<span class="pl-en">getTrack</span>(<span class="pl-c1">this</span>.<span class="pl-smi">time</span>);
  }
}</pre></div>
<p>If the sub class declares no explicit constructor, as was the case with <code>RecordPlayer</code> and <code>CassettePlayer</code>, then when someone calls <code>new RecordPlayer()</code> JavaScript just skips <code>RecordPlayer</code> and invokes the constructor on <code>MusicPlayer</code>.</p>
<p>However, if child classes need their own constructor, such as <code>CdPlayer</code> because they need to perform their own initialization, then the sub class will also declare a constructor, and the following sequence will occur when <code>new CdPlayer()</code> is called:</p>
<ol>
<li>The <code>constructor</code> of CdPlayer is invoked</li>
<li>The first line of the CdPlayer <code>constructor</code> is <em>required</em> to call <code>super()</code> which is an alias for the constructor on <code>MusicPlayer</code>.</li>
<li>The <code>constructor</code> for <code>MusicPlayer</code> is invoked</li>
<li>The <code>constructor</code> for <code>MusicPlayer</code> returns</li>
<li>The <code>constructor</code> for <code>CdPlayer</code> resumes</li>
<li>When the <code>constructor</code> for <code>CdPlayer</code> returns, we have an Object!</li>
</ol></article></body></html><script async>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script>